# 实验二 图像处理基本操作

王瑞哲  PB19071509



## >>> 实验原理

数字图像处理(Digital Image Processing)是通过计算机对图像进行去除噪声、增强、复原、分割、提取特征等处理的方法和技术。OpenCV是一个基于Apache2.0许可（开源）发行的跨平台计算机视觉和机器学习软件库，可以运行在Linux、Windows、Android和Mac OS操作系统上。它轻量且高效——由一系列 C 函数和少量 C++ 类构成，同时提供了Python、Ruby、MATLAB等语言的接口，实现了图像处理和计算机视觉方面的很多通用算法。



## >>> 实验目标

本次实验进⾏图像处理的基本操作和底层处理算法，了解数字图像的基本形式和基本滤波操作，具体包括： 

1. 图像读取、写入、平移、旋转、缩放等操作；
2. 图像滤波：平滑（均值滤波 、⾼斯滤波、中值滤波、双边滤波）、边缘提取（Sobel、Canny 、 DOG 、LOG）；
3. 图像特征：灰度直方图、颜色直方图（ RGB 空间、 HSV 空间）、 方向梯度直方图（Histogram Of Gradient）。



## >>> 实验过程

#### 1. 图像读取、写入、平移、旋转、缩放

通过这一处理来放大高频，使用一阶滤波器$y(t) = x(t) - \alpha x(t-1), \ \ \ \  0.95 < \alpha < 0.99$，并选择$\alpha=0.97$

```python
alpha = 0.97
s = np.append(s[0], s[1:] - alpha * s[:-1])
```

这一步用于平衡频谱，避免在傅立叶变换操作期间出现数值问题，同时还可改善信号噪声比。



#### 2. 图像滤波：平滑（均值滤波 、⾼斯滤波、中值滤波、双边滤波）、边缘提取（Sobel、Canny 、 DOG 、LOG）

为避免对整个信号进行傅立叶变换时随时间丢失信号的频率轮廓，假设信号的频率在很短的时间内是固定的，通过在此短时帧上进行傅立叶变换，我们可以通过串联相邻帧来获得信号频率轮廓的良好近似值。 选择帧长为 25ms，帧移为 10ms（重叠 15ms）

```py
frame_size, frame_stride = 0.025, 0.01
frame_length, frame_step = int(round(frame_size * sample_rate)), int(round(frame_stride * sample_rate))
signal_length = len(s)
num_frames = int(np.ceil(np.abs(signal_length - frame_length) / frame_step)) + 1

pad_signal_length = (num_frames - 1) * frame_step + frame_length
z = np.zeros((pad_signal_length - signal_length))
pad_signal = np.append(s, z)

indices = np.arange(0, frame_length).reshape(1, -1) + np.arange(0, num_frames * frame_step, frame_step).reshape(-1, 1)
frames = pad_signal[indices]
```



#### 3. 图像特征：灰度直方图、颜色直方图（ RGB 空间、 HSV 空间）、方向梯度直方图（Histogram of Gradient）

选择汉明hamming窗$w(n) = 0.54 - 0.46 cos(\frac{2\pi n}{N-1})$

这一步可以直接利用numpy库的内置函数实现

```python
hamming = np.hamming(frame_length)
frames *= hamming
```





## >>> 实验总结与思考

通过本次实验，我基本了解到了MFCC特征提取在语音信号处理领域的基本应用和实现过程，同时熟悉了python语法的使用和基本库的调用方法。

对于FBank特征和MFCC特征的选取方面：FBank特征的提取更多的是希望符合声音信号的本质，拟合人耳接收的特性。而MFCC特征多的那一步则是受限于一些机器学习算法。很早之前MFCC特征和GMMs-HMMs方法结合是ASR的主流。而当一些深度学习方法出来之后，MFCC则不一定是最优选择，因为神经网络对高度相关的信息不敏感，而且DCT变换是线性的，会丢失语音信号中原本的一些非线性成分。

因此，在模型对高相关的信号不敏感时（比如神经网络），可以用FBank特征；在模型对高相关的信号敏感时（比如GMMs-HMMs），需要用MFCC特征。从目前的趋势来看，因为神经网络的逐步发展，FBank特征越来越流行。