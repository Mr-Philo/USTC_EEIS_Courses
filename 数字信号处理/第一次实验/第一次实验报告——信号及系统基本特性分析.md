# 2021秋数字信号处理第一次实验报告——**信号及系统基本特性分析**

​																																	PB19071509  王瑞哲

### 一、实验目的

1. 学习 Matlab 编程的基本方法；掌握常用函数用法； 
2. 了解不同信号的频域特性，理解时域特性与频域特性之间的关联性； 
3. 掌握典型信号序列的时域和频域基本特性；
4.  熟悉理想采样的性质，了解信号采样前后的频谱变化，加深对采样定理的理解；
5. 了解离散系统的时域/频域特性及其对输出信号的影响，掌握系统分析方法；

### 二、实验原理

- ##### **连续时间信号的采样**

  对一个连续时间信号进行理想采样的过程可以表示为该信号的一个周期冲激脉冲的乘积，相当于原信号$x_a(t)$乘上周期序列脉冲$M(t)$。其中$M(t)$定义为：$M(t)=\sum\limits_{n=-\infty}^{+\infty}{\delta(t-nT)}$

  可以证明，原信号$x_a(t)$和理想采样信号$\hat{x}_a(t)=x_a(t)M(t)$的拉氏变换分别为：
  $$
  X_a(s)=\int_{-\infty}^{+\infty}x_a(t)e^{-st}dt
  $$

  $$
  \hat{X}_a(s)=\frac{1}{T}\sum_{m=-\infty}^{+\infty}\int_{-\infty}^{+\infty}X_a(s-jm\Omega _s)
  $$

  作为拉氏变换的特例，信号理想采样的傅立叶变换为：
  $$
  \hat{X}_a(j\Omega )=\frac{1}{T}\sum_{m=-\infty}^{+\infty}X_a[j(\Omega-j\Omega _s)]
  $$
  由此可知，信号理想采样后的频谱是原信号频谱的周期延拓，其延拓周期等于采样频率。根据 奈奎斯特采样定理，如果原信号是带限信号，且采样频率高于原信号最高频率分量的 2 倍，则采样以后不会发生频谱混淆现象。

  在计算机中处理信号时，会将上述公式转化为离散时间序列$x(n)$进行求解。

- ##### **有限长序列分析**

  一般来说，在计算机上不可能，也不必要处理连续的曲线 $X(e^{j\omega})$ 。通常，我们只要观察、分析 $X(e^{j\omega})$在某些频率点上的值。对于长度为 N 的有限长序列$x(n)$，一般只需要在$0-2\pi$之间均匀地取$M$个频率点，计算这些点上的序列傅立叶变换：
  $$
  X(e^{j\omega k})=\sum_{n=0}^{N-1}x(n)e^{-j\omega _kn}
  $$
  其中$\omega _k=2\pi k/M$，k=0,1,..,M-1。 $X(e^{j\omega k})$ 是一个复函数，它的模就是幅频特性曲线。

- ##### **信号卷积**

  一个线性时不变离散系统的响应 y(n)可以用它的单位冲激响应 h(n)和输入信号 x(n)的卷积来表示：
  $$
  y(n)=x(n)*h(n)=\sum_{m=-\infty}^{+\infty}x(m)h(n-m)
  $$
  根据傅立叶变换和 Z 变换的性质，与上式对应应该有
  $$
  Y(z)=X(z)H(z)\quad Y(e^{j\omega})=X(e^{j\omega})H(e^{j\omega})
  $$
  上两式告诉我们，可以通过对两个序列的移位、相乘、累加计算信号响应，也可以在频域上用乘积等价实现时域上的卷积操作。



### 三、实验内容

**备注**：实验指导书中的前三条要求（1、 记录实验内容中要求观察、分析、比较的内容及结果并进行分析；2、 总结在上机实验内容中要求比较时域、幅频曲线差异差异部分内容的结果，定性分析它们正确与否，并简要说明这些结果的含义；3、 在实验报告中附上在实验过程中记录的各个典型信号序列的时域和幅频特性曲线，分析所得到的结果图形，说明各个信号的参数变化对其时域和幅频特性的影响），本次实验报告将它们融合在此部分中，在逐条实验内容的分析中呈现出来。

1. ##### **理想采样信号序列的特性分析**

   对信号 $x_a(t)=Ae^{-\alpha t}sin(\Omega_0t)u(t)$ 进行理想采样，可以得到一个理想的采样信号序列：$x_a(t)=Ae^{-\alpha t}sin(\Omega_0nT),0\le n<50$，其中 $A$ 为幅度因子， $\alpha$ 是衰减因子， $\Omega_0$ 是频率，$T$为采样周期。

   产生理想采样信号序列$x_a(n)$，使$A=444.128,\alpha=50\sqrt{2}\pi,\Omega_0=50\sqrt{2}\pi$。使采样频率分别为1000Hz，300Hz，200Hz，即周期T分别为1/1000，1/300，1/200，观察所得理想采样信号的幅频特性。

   <img src="D:\wrz\software\matlab\DSP\exp1\exp1_1.jpg" alt="exp1_1"  />

   实验结果如上图所示。正弦序列的理论幅频曲线应出现冲激尖峰，而衰减正弦序列的幅频曲线则表现出有一定展宽的谱峰，第一列图像（T=1/1000）较符合这一预期。但**若采样频率下降**（亦即采样周期增加），根据时域取样与DTFT理论分析可知，**此时的频谱会产生泄露现象**。如第二列图像（T=1/300），在频谱图像中部有大量的非零值，与理论情况不符合；而第三列图像（T=1/200）的**采样频率更低，频谱泄露现象更严重**。事实上，从时域序列图上也可以看出，采样频率过低时，采样所得的时域序列图相较于原模拟信号已经有了很大的失真度，已经无法辨认出是衰减正弦序列，对应的频谱图也就不可避免地会与实际应得到的频谱图产生较大的偏差。

2. ##### **典型信号序列的特性分析**

   1）**观察高斯序列的时域和频域特性**

   产生高斯序列：
   $$
   x_{aa}(n)=\begin{cases} e^{-\frac{(n-p)^2}{q}}，0\le n\le15\\ 0， else\end{cases}
   $$
   首先，固定信号$x_{aa}(n)$​中的参数 p=8，改变 q 的值使之分别等于2，4，8，观察它们的时域和频域特性，了解q 取不同值的时候，对信号时域特性和幅频特性的影响。

   然后，固定 q=8，改变 p 之分别等于 8，13，14，观察参数 p 变化对信号序列时域及幅频特性的影响。注意 p 等于多少时，会发生明显的泄漏现象，混淆现象是否也随之出现？记录实验中观察到的现象，绘制相应的时域序列和幅频特性曲线。

   <img src="D:\wrz\software\matlab\DSP\exp1\exp1_2_1.png" alt="exp1_2_1"  />

   实验结果展示在上图中。其中第三列图像为取值q=8，p=8的情况，此时序列的非0值较为均匀地分布在0-15这些取样点上，此时计算出的频域图像有较为明显的峰值，且有较多无关点处取0值，与高斯序列的理论幅频特性符合得较好。

   改变p值时，在时域上会改变高斯序列峰值所在位置（高斯序列中时域峰值恰好处于均值p处），如上图第3、4、5列图像，相当于对图像做平移。但采样区间0-15是不变的，如果p值不恰好处于采样区间均值（8）的位置，则所采样的序列便不能完整地反应所有非零值，相当于对周期信号的采样没有截取完整的周期，则频谱相应地发生泄漏。如上图第3、4、5列图像，随着偏移值越来越大，频谱泄露程度也越来越严重。

   改变q值时，在时域上会改变高斯序列尖峰的尖锐程度——q值越小，峰值越尖锐，如上图第1、2、3列图像。但此时离散采样的间隔并未改变，若峰值很尖锐，则采样得到的序列值就会不够精确以至于丢失了部分非零值，如图像上的采样点分布一样。与第一部分实验同理，采样序列值稀疏时，所得到的频域图像也会产生对应失真，且采样越稀疏，失真越严重，如1，2，3列图像所示。

   2）**观察衰减正弦序列的时域和幅频特性**

   产生衰减正弦序列：
   $$
   x_{bb}(n)=\begin{cases} e^{-\alpha n}sin2\pi fn，0\le n\le15\\ 0， else\end{cases}
   $$
   令 $\alpha=0.1$ 并且 $f=0.0625$，检查谱峰出现的位置是否正确，注意频谱的形状，绘制幅频特性曲线。改变 $f=0.4375$，再变化 $f=0.5625$，观察这两种情况下，频谱的形状和谱峰出现的位置，有无混淆和泄漏现象发生？说明产生现象的原因。

   ![exp1_2_2](D:\wrz\software\matlab\DSP\exp1\exp1_2_2.png)

   运行结果如上图所示。当 $f=0.0625$时，原信号的周期为$T=\frac{1}{f}=16$，对应频谱峰值也应出现在第16个采样点即$n=15$处。观察第一列图像，可知时域图像周期和频域峰值都出现在预期位置（频域图像是中心对称的，所以n=1（在matlab中被反应为下标2，因为matlab数组从1开始计数）处也有另一个对称的峰）。由于是衰减正弦序列，故频谱的峰值有一定的展宽，但由于衰减系数不大，主峰依然较为明显。

   改变 $f=0.4375$，再变化 $f=0.5625$，此时频谱分辨率 $f_0=0.0625$ 已不满足奈奎斯特采样定理，则频域图像不可避免地会产生混叠。当$f=0.4375$时，频谱峰出现在$n=f/f_0=0.4375/0.0625=7$ 的位置，但由于频谱混叠，在n=7关于0-15的中心对称（n=9）处也会有另一对称峰，如第二列图所示（matlab中的数组下标都会在n的基础上+1）；当$f=0.5625$时，频谱峰出现在$n=f/f_0=0.56255/0.0625=9$ 的位置，但由于频谱混叠，在n=9关于0-15的中心对称（n=7）处也会有另一对称峰，如第三列图所示。于是就可以“巧合”地发现，这两种情况下的频谱图像是**完全一致的**。实际上，本题的采样频率为 $nf_0=16\times0.0625=1$ ，而这两个频率 $f=0.4375$， $f=0.5625$ 相加恰好为1，即互为“镜像频率”。

   **选做：**将 $x_{bb}(n)$ 信号的长度 N 设为 63，用 Matlab 中 $randn(1,N)$ 函数产生一个噪声信号 $w(n)$，计算将这个噪声信号叠加到 $x_{bb}(n)$ 上以后新信号 $y(n)=x_{bb}(n)+w(n)$ 的频谱，观察发生的变化并记录。在此基础上，改变参数 $\alpha$ 和 $f$，观察在出现混淆现象和泄漏现象的时候有噪声的 $y(n)$ 信号的频谱有什么变化，是否明显？

   ![exp1_2_4](D:\wrz\software\matlab\DSP\exp1\exp1_2_4.png)

   实验结果如图所示。由于原衰减正弦序列的峰值就只有$A=1$，因此这里只添加了幅度为0.1的随机噪声，即在 $randn(1,N)$ 函数基础上乘了0.1的系数，否则时域波形会直接变为无规律的杂乱点序列。观察添加随机噪声的时域序列和频谱，可知在随机噪声幅值不大时，时遇上仍能看出衰减正弦规律，但由于随机噪声的不确定性，时域上可能会出现值的跳变，导致频域会混入高频成分，导致频域序列点变得杂乱无章，这一点尤其是在随机噪声幅值与n较大时的时域值相近时体现更为明显；反映在如上图所示的频域图上，频域序列点就变得更为复杂，各频率分量都有存在。

   3）**观察三角波序列和反三角波序列的时域和幅频特性**

   产生三角波序列和反三角波序列：
   $$
   x_{cc}(n)=\begin{cases} n+1，0\le n\le3\\ 8-n， 4\le n\le7\\ \quad 0\quad，else\end{cases}\qquad\qquad x_{dd}(n)=\begin{cases} 4-n，0\le n\le3\\ n-3， 4\le n\le7\\ \quad 0\quad，else\end{cases}
   $$
   针对信号 $x_{cc}(n)$ 和 $x_{dd}(n)$：首先用 8 点 FFT 分析幅频特性，观察两者的序列形状和频谱曲线有什么异同？注意此时的  $x_{dd}(n)$ 可以看作是 $x_{cc}(n)$ 经过圆周移位以后得到的，并绘制两者的序列和幅频特性曲线。其次在 $x_{cc}(n)$ 和 $x_{dd}(n)$ 末尾补零，用 16 点 FFT 分析这两个信号的幅频特性，观察幅频特性发生了什么变化？两个信号之间的FFT 频谱还有没有相同之处？这些变化说明了什么？

   ![exp1_2_3](D:\wrz\software\matlab\DSP\exp1\exp1_2_3.png)

   运行结果如上图所示。可见，$x_{cc}(n)$ 和 $x_{dd}(n)$ 的8 点 FFT 频谱完全一致，因为 $x_{cc}(n)$ 和 $x_{dd}(n)$ 的序列长度均为8，此时的  $x_{dd}(n)$ 可以看作是 $x_{cc}(n)$ 经过圆周移位以后得到的，故频谱结果完全一致。但若在时域序列末尾补零至16点序列再做16点FFT，此时 $x_{dd}(n)$ 由于两者末尾的0值就不能看作是 $x_{cc}(n)$ 经过圆周移位以后得到的，所以两者的频谱图象就不一致了。

3. ##### **离散信号、系统和系统响应的分析**

   1）**信号序列产生**

   产生如下信号序列：

   ① 理想的采样信号序列：$x_a(t)=Ae^{-\alpha t}sin(\Omega_0nT),0\le n<50$，其中 $A$ 为幅度因子， $\alpha$ 是衰减因子， $\Omega_0$ 是频率，$T$为采样周期。

   ②单位脉冲序列  $x_b(n)=\delta(n)=\begin{cases}1,n=0\\0,n\ne0 \end{cases}$

   ③矩形序列  $x_c(n)=R_N(n)=\begin{cases} 1,0\le n<N-1\\0,else \end{cases}$，其中$N=10$

   产生如下系统单位脉冲响应序列，本实验中用到两种 FIR 系统：

   ① $h_a(n)=R_{10}(n)$

   ② $h_b(n)=\delta(n)+2.5\delta(n-1)+2.5\delta(n-2)+\delta(n-3)$

   2）**离散信号、系统和系统响应的分析**

   - 观察信号 $x_b(n)$ 和系统 $h_b(n)$ 的时域和幅频特性；利用线性卷积求信号通过系统以后的响应。比较系统响应和系统 $h_b(n)$ 的时域及幅频特性。注意它们之间有无差异，绘出图形。

     ![exp1_3_1](D:\wrz\software\matlab\DSP\exp1\exp1_3_1.png)

     实验结果如上图所示。由于 $x_b(n)$ 为单位脉冲序列 $\delta(n)$，由傅里叶变换性质，其频谱信号应为全1序列，与其他信号时域卷积仍为信号自身。因此系统响应 $y(n)$的时域特性和频域特性都与原信号 $hb(n)$ 没有差异，如上图所示，符合理论分析结果。

   - 观察信号 $x_c(n)$ 和系统 $h_a(n)$ 的时域和幅频特性，利用线性卷积求系统响应。判断响应序列图形及序列非零值长度是否与理论结果一致。利用序列的傅立叶变换数值计算子程序求出 $Y(e^{j\omega})$ 观察响应序列的幅频特性。定性判断结果正确与否。改变信号 $x_c(n)$ 的矩形宽度，使 $N=5$，重复以上动作，观察变化，记录改变参数前后的差异。

     ![exp1_3_2](D:\wrz\software\matlab\DSP\exp1\exp1_3_2.png)

     实验结果如上图所示。其中信号 $x_c(n)$ 和系统 $h_a(n)$均为10点矩形窗函数，它们的频谱均为采样函数$Sa(x)$，图中第一列、第二列图像的计算结果与预期相符； $x_c(n)$ 与 $h_a(n)$ 的线性卷积结果应为三角序列，序列非零值长度为 $N_1+N_2-1=19$，其频域响应应为 $Sa^2(x)$，第三列图像的时域和频域特性均与预期相符。

     ![exp1_3_2_2](D:\wrz\software\matlab\DSP\exp1\exp1_3_2_2.png)

     改变信号 $x_c(n)$ 的矩形宽度，使 $N=5$后，实验结果如上图所示。$N=5$点的矩形窗序列和$N=10$点的矩形窗序列做线性卷积的结果为长$N_1+N_2-1=14$的梯形序列，如第三列时域图所示，而其频域响应为两种采样函数$Sa_1(x)$和$Sa_2(x)$相乘，实验结果均与理论值相符合。

   - 将上一步实验中的信号换为 $x_a(n)$ ，其中$A=1,\alpha=0.4,\Omega_0=2.0734,T=1$。重复各步骤，改变 $x_a(n)$ 的参数 $\alpha=0.1$ 再重复各步骤；改变参数$\Omega_0=1.2516$ ，重复各步骤。在实验中观察改变 $\alpha$ 和 $\Omega_0$ 对信号及系统响应的时域和幅频特性的影响，绘制相应的图形。

     ![exp1_3_3](D:\wrz\software\matlab\DSP\exp1\exp1_3_3.png)

     实验结果如上图所示。其中衰减正弦序列的频率 $\Omega_0=2.0734$，而采样频率只有1，不满足奈奎斯特采样定理，因此频谱不可避免地会发生混叠，如第一列图像所示。时域 $x(n)$ 与10点矩形窗序列 $h_a(n)$ 卷积后，其时域和频域特性如第三列图像所示。
     
     ![exp1_3_3_2](D:\wrz\software\matlab\DSP\exp1\exp1_3_3_2.png)
     
     改变衰减度 $\alpha=0.1$，图像如前两列所示。可以看出，衰减度减小后，原时域序列 $x_a(n)$ 的有效正采样值变多了，这使得时遇上能提供更多关于原序列的信息，使得它所对应的幅度谱的峰值较为明显，即失真度减小，而峰值位置相较于不改变$\alpha$时没有变化。而改变 $\Omega_0=1.2516$ 时，相当于降低了原信号的频率，但已有的采样频率仍不能满足奈奎斯特采样定理的要求，但其频谱泄露情况有所改善。据此可以进一步改善两参数的值，如取 $\alpha=0.1,\Omega_0=0.3142(0.1\pi)$ 时，对应时域特性和频域特性为：
     
     ![exp1_3_3_3](D:\wrz\software\matlab\DSP\exp1\exp1_3_3_3.png)
     
     可见在这样的参数设置下，幅度谱的峰值已经较为明显，且没有严重的泄露情况；而幅度谱上的峰展宽由衰减因子引起，进一步缩减衰减因子还可以获得更小的展宽。
   
   3）**卷积定律的验证**
   
   利用卷积定律将 $x_a(n)$ 和系统 $h_a(n)$ 的傅氏变换相乘，直接求得 $Y(e^{j\omega})$；将得到的幅频特性曲线和上一实验中得到的曲线进行比较，观察二者有无差异，验证卷积定律。
   
   ![exp1_3_4](D:\wrz\software\matlab\DSP\exp1\exp1_3_4.png)
   
   由上图可见，两种方式得到的幅度谱完全一致。这说明采用 $x_a(n)$ 和系统 $h_a(n)$ 的傅氏变换相乘，直接求得 的 $Y(e^{j\omega})$ 与通过将信号 $x_a(n)$ 和系统 $h_a(n)$ 线性卷积的结果 $y(n)$ 进行傅里叶变换得到的 $Y(e^{j\omega})$​ 完全一致，由此验证了卷积定律：
   $$
   y(n)=x(n)*h(n)=\sum_{m=-\infty}^{+\infty}x(m)h(n-m)\\Y(z)=X(z)H(z)\quad Y(e^{j\omega})=X(e^{j\omega})H(e^{j\omega})
   $$

##### 	选做内容

- 改变信号 $x_a(t)$ 中的衰减因子$\alpha$ ，先定性估计频谱可能产生的变化，然后观察其频谱的变化，记录结果，变化是否你所想的一致，这说明了什么？

  $x_a(t)$为衰减正弦序列：$x_a(t)=Ae^{-\alpha t}sin(\Omega_0nT),0\le n<50$。这里为了使除$\alpha$以外的参数不会过于影响频谱，取$A=1,\Omega_0=0.2,T=1$，使频谱失真度尽量小，再改变$\alpha$的值，研究频谱变化情况：

  ![exp1_4_1](D:\wrz\software\matlab\DSP\exp1\exp1_4_1.png)

  可以看出，$\alpha=0.4$时，时域信号迅速衰减，几乎看不出正弦趋势，所得到的频谱峰值也很少；但随着$\alpha$的逐渐减小，时域信号的正弦序列也越来越明显，对应幅度谱上的峰也越来越明显，峰值逐渐增大，而且峰的锐度也随之增大，因为$\alpha$的减小一方面导致序列值的增大，一方面也降低了原正弦序列的失真度。

- 一个 LTI 系统的冲激响应为 $h(n)=(0.9)^nu(n)$，输入序列为 $x_c(n)$ ，求系统响应 $H(e^{j\omega})$ 和输出信号 $y(n) $及其频谱 $Y(e^{j\omega})$；如果 $h(n)=x_c(n)$ ，其结果又如何？

  ![exp1_4_2](D:\wrz\software\matlab\DSP\exp1\exp1_4_2.png)

  运行结果如上图所示，其中第一列图像为前面已经提及的十点矩形窗序列$x_c(n)$，第二列为所设计的冲激响应$h(n)$，第三列为系统响应结果，第四列为将$h(n)$替换为$x_c(n)$的结果。

- 编写一个程序，将 $x_c(n)$ 分解为奇偶序列，绘制奇偶序列时域图形并求出它们频谱 $X_e(e^{j\omega})$ 和 $X_o(e^{j\omega})$ ，同  $x_c(n)$ 的频谱 $X_c(e^{j\omega})$ 进行比较，可以得出什么结论？

  依题意，$x_c(n)$为10点长度矩形窗序列，对其分解为奇偶序列首先需要将其定义域扩充至n=负值的情况。为便于观察，取n的范围为[-10,10]共21个点。根据求奇偶分量的公式：
  $$
  x_e(n)=\frac{x(n)+x(-n)}{2}\qquad x_o(n)=\frac{x(n)-x(-n)}{2}
  $$
  在对其分别进行傅里叶频谱分析。给出matlab实现代码如下：

  ```matlab
  % xc(n):十点矩形序列 1<=N<=10
  % 欲求其奇偶序列，要将其定义域扩展至n=负数的情况
  n=-10:10;     % 算上原点处xc(0)=1，共21个点
  N=10;
  xc=sign(sign(n)+sign(N-n));
  xcc=sign(sign(-n)+sign(N+n));   %xc做时域反转
  xe=0.5*(xc+xcc);    % 偶分量
  xo=0.5*(xc-xcc);    % 奇分量
  
  figure(1);
  subplot(2,3,1);stem(n,xc);title('矩形窗序列xc(n)');axis([-10,10,-1,1]);
  subplot(2,3,4);stem(abs(fft(xc)));title('矩形窗序列幅度谱');
  subplot(2,3,2);stem(n,xe);title('偶分量xe(n)');axis([-10,10,-1,1]);
  subplot(2,3,5);stem(abs(fft(xe)));title('偶分量幅度谱');
  subplot(2,3,3);stem(n,xo);title('奇分量xo(n)');axis([-10,10,-1,1]);
  subplot(2,3,6);stem(abs(fft(xo)));title('奇分量幅度谱');
  
  figure(2);
  subplot(2,2,3);stem(abs(fft(xc)));title('矩形窗序列幅度谱');
  subplot(2,2,2);stem(abs(fft(xe)));title('偶分量幅度谱');
  subplot(2,2,1);stem(abs(fft(xo)));title('奇分量幅度谱');
  subplot(2,2,4);stem(abs(fft(xe))+abs(fft(xo)));title('奇偶分量幅度谱之和');
  ```

  分别绘制出原序列、偶分量序列和奇分量序列的时域、频域特性为：

  ![exp1_4_3_1](D:\wrz\software\matlab\DSP\exp1\exp1_4_3_1.png)

  将原序列、偶分量序列、奇分量序列频谱和奇偶分量频谱之和绘制在同一张图片中，可得：

  ![exp1_4_3_2](D:\wrz\software\matlab\DSP\exp1\exp1_4_3_2.png)

  可见，**原序列频谱模和奇偶分量频谱模之和相等**，即$|X_c(e^{j\omega})|=|X_e(e^{j\omega})|+|X_o(e^{j\omega})|$. 这是由离散傅里叶变换的对称性质而来的：

  - 若 $x(n)$ 的离散傅里叶变换为 $X(k)$ ，则 $x(-n)$ 的离散傅里叶变换为 $X(-k)$，$x^*(n)$ 的离散傅里叶变换为 $X^*(-k)$；
  - 对实偶序列而言，$x(n)=x^*(n)=x(-n)$，因此 $X(k)=X^*(-k)=X(-k)$，所以实偶序列的离散傅里叶变换也是实偶对称的；
  - 对实奇序列而言，$x(n)=x^*(n)=-x(-n)$，因此 $X(k)=X^*(-k)=-X(-k)$，所以实奇序列的离散傅里叶变换是纯虚奇对称的；
  - 因此对原序列做奇偶分解 $x(n)=x_e(n)+x_o(n)$，则按上述性质，其对应频谱分量做**实虚分解**，即$X_c(e^{j\omega})=X_e(e^{j\omega})+jX_o(e^{j\omega})$，故进而有$|X_c(e^{j\omega})|=|X_e(e^{j\omega})|+|X_o(e^{j\omega})|$，即奇偶分量频谱模之和等于原序列频谱模。

- 针对信号 $x(t)=cos6000\pi t+cos1000\pi t$ 分析采样率、信号功率。

  该信号只有两个频率分量：$f_1=500Hz,f_2=3000Hz$。按奈奎斯特采样定理，采样率$f_s\ge2f_m=6kHz$，但其实该信号只有两个点频，采样频率降低也不会产生频谱混叠，除非某些特殊值（如$f_2-f_1=2.5kHz$）使得频域平移时恰好发生频率点的重合。但考虑到实际采样中有限点截断不可避免地会产生频谱混叠，保险做法还是以 $f_s\ge6kHz$ 进行采样。

  该信号的信号功率为：
  $$
  P=\lim_{T\rightarrow+\infty}\int_{-T}^{T}\frac{1}{2T}|x(t)|^2dt=\lim_{T\rightarrow+\infty}\int_{-T}^{T}\frac{1}{2T}(cos\frac{6\times2\pi}{T}t+cos\frac{2\pi}{T}t)^2dt\quad(T=\frac{1}{f_1}=0.002)\\=\lim_{T\rightarrow+\infty}\int_{-T}^{T}\frac{1}{2T}(cos
  ^2\frac{12\pi}{T}t+2cos\frac{12\pi}{T}t\times cos\frac{2\pi}{T}t+cos^2\frac{2\pi}{T}t)dt\\
  =\lim_{T\rightarrow+\infty}\frac{1}{2T}(\frac{1}{2}\times2T+\frac{1}{2}\times2T)=\lim_{T\rightarrow+\infty}\frac{1}{2T}\times2T=1
  $$



### 四、分析总结

1、 记录实验内容中要求观察、分析、比较的内容及结果并进行分析。

2、 总结在上机实验内容中要求比较时域、幅频曲线差异差异部分内容的结果，定性分析它们正确与否，并简要说明这些结果的含义。

3、 在实验报告中附上在实验过程中记录的各个典型信号序列的时域和幅频特性曲线，分析所得到的结果图形，说明各个信号的参数变化对其时域和幅频特性的影响。

（1、2、3点已在第三部分实验内容中完成）

**4、 总结一下你在用 MatLab 进行数字信号处理实验项目的时候常用的函数及其功能。**

​	在本次函数中，经常用到的matlab函数有：

- **stem()**函数		其功能为将输入序列做茎状图描绘，适合本实验中对于离散序列的描绘和展示。与之相关的其他功能扩展函数有：

  - subplot()函数 		其功能为在一张图上绘制多个子图片，适合有关联的多张图像展示。参数为(x,y,n)，x*y为图片总数（行\*列），n为当前子图片要放置的位置
  - title()函数                其功能为给图片取标题名
  - xlabel()函数            其功能为给图像x轴增添标签，ylabel()同理

- **fft()**函数              Matlab内置的计算快速傅里叶变换函数，它的使用方法主要有：

  - Y = fft(X) ——用快速傅里叶变换 (FFT) 算法计算 X 的离散傅里叶变换 (DFT)。

    如果 X 是向量，则 fft(X) 返回该向量的傅里叶变换。

    如果 X 是矩阵，则 fft(X) 将 X 的各列视为向量，并返回每列的傅里叶变换。

  - Y = fft(X,n) ——返回 n 点 FFT 结果。如果未指定任何值，则 Y 的大小与 X 相同。

    如果 X 是向量且 X 的长度小于 n，则为 X 补上尾零以达到长度 n。

    如果 X 是向量且 X 的长度大于 n，则对 X 进行截断以达到长度 n。

    如果 X 是矩阵，则每列的处理与在向量情况下相同。

  - 函数fft返回值的数据结构具有对称性，即其频谱以Nyqusit频率（即采样频率的一半）为轴对称的，Y的前一半与后一半是复数共轭关系。

- **abs()**函数             对输入参数取绝对值，在本实验中用于将幅度计算结果取模值以输出幅度谱。

- **zero()**函数           用于生成一列全0序列。参数为($N_1$,$N_2$)，用于标识序列起始位置。

- **conv()**函数           用于计算两向量线性卷积，输入参数为待计算卷积的两序列，输出为卷积计算结果，其序列长度为$N_1+N_2-1$。

- **sign()**函数            本实验中用于辅助生成矩形窗函数。当sign()函数输入参数为正值时输出为1，输入参数为负值时输出为-1，输入参数为0时输出为0。本实验中使用两次sign()函数（消除输出值-1的影响）生成矩形窗函数，如 `ha=sign(sign(10-n)+1);` 语句可以生成长度为10的矩形窗序列。

**5、 总结实验中根据实验现象得到的其他个人结论。**

​	本次实验中，我的收获与个人结论为：

- 习惯并适应matlab编程语法。典型的区别**如信号乘 $.*$ 和矩阵乘 $*$** 。例如对于一长50点的序列，Matlab中会将其认为成1×50的矩阵。此时如果要做两信号的时域相乘，**直接采用$*$的话，matlab会产生报错，原因是1×50的矩阵不能和1×50的矩阵相乘**。解决办法是将其换为信号乘$.*$，便可正常运行。其他语法还有如下面语句 `n=0:49` 在matlab中可以直接生成一个从0到49共50点的序列，也就是一个1×50的矩阵。

- **matlab中的DFT计算**。在参考例程中，计算序列DFT结果的语句为：

  ```matlab
  W=exp(-1i*pi/25); X=x*W.^(n'*k);
  ```

  其中$li$为复数单位，$W$为旋转因子。**理解该式的关键在于理解 .^ 算符**。matlab中，.^2是矩阵中的每个元素都求平方，^2是求矩阵的平方或两个相同的矩阵相乘。这里先运算W.^(n'\*k)——即为旋转因子$W$的 $n'*k$ 乘方，其中$n$和$k$都是0到49的序列，或说为维数1×50的矩阵。$n'$表示对$n$做转置，则$n'*k$ 相当于50×1的矩阵和1×50的矩阵相乘，结果为50×50的矩阵，该矩阵通过.^作用于旋转因子上，相当于这个矩阵的每个元素作为指数，底数全变成$W$，**便得到了我们熟悉的50×50的旋转因子的矩阵**。

  则再计算原矩阵x（维数1×50）矩阵乘（\*）该旋转因子矩阵（维数50×50），便可得到维数1×50的DFT结果序列$X(k)$。其中$X(k)$的每一个元素对应$k$不变时，$n$从0到49积分，恰好对于旋转因子矩阵的每一列，**所以前面的计算中必须是 $n'*k$，让变量$k$位于列的位置**，而不能变换顺序成 $k'*n$。

- matlab还具有强大的**绘图展示能力**。本次实验中只使用了最基本的stem()函数和subplot()等辅助函数，但其实还有绘制散点图的plot()函数、柱状图bar()、直方图hist()、向量图compass()等等，还可以利用axis()函数调整坐标轴范围，lengend()函数显示注解，grid on指令显示网格，还可以在绘制函数中修饰图像的宽度、高度、颜色、线形、点形等等……只要经过精心设计，matlab绘制出的图像可以变得非常清晰且美观。

- 通过本次实验，我进一步了解到了不同信号的时域、频域特性，理解了时域特性与频域特性之间的关联性；更加熟悉了理想采样的性质，了解到了信号采样前后的频谱变化，加深了对奈奎斯特采样定理的理解；同时经过动手实验，验证了傅里叶变换性质之卷积定理，对离散系统的输入输出关系及其分析方法有了更加深刻的认识和体会。